
## Ход работы
### 1. SAST анализ

Была использована утилита bandit.

<img width="974" height="813" alt="image" src="https://github.com/user-attachments/assets/d052767b-fcab-4bb8-b6c8-6840ccb7a3fb" />

По результатам анализа были найдены следующие уязвимости:

Высокий риск :
Использование pickle.loads() на пользовательских данных (строка 166) — критическая уязвимость десериализации недоверенных данных. Позволяет выполнить произвольный код (RCE).

subprocess с shell=True (строка 185) — OS Command Injection. Пользовательский ввод может выполнить любые shell-команды на сервере.

subprocess.Popen с shell=True (строка 184–185) — аналогично, прямой вызов команд с повышенными правами.

Средний риск:
Flask в debug-режиме (debug=True) (строка 256) — включает Werkzeug debugger с интерактивной консолью (/console). При известном PIN даёт Remote Code Execution.

Низкий риск:
Импорт модулей pickle и subprocess — сами по себе не уязвимость, но указывают на потенциально опасный код.


При работе с Semgrep возникли технические сложности: проблемы с сетевым подключением для загрузки правил и ошибки кодировки конфигурационных файлов (вероятнее всего из-за блокировок российских ip-адресов).

<img width="988" height="515" alt="image" src="https://github.com/user-attachments/assets/6b3936d6-befd-4670-a730-e6e52bfceeb7" />



###  Запуск уязвимого приложения на локальном хосте

<img width="974" height="620" alt="image" src="https://github.com/user-attachments/assets/c725abad-6787-48ed-b1aa-a750108f2bde" />


#### 2.1. Анализ с помощью nikto

<img width="974" height="437" alt="image" src="https://github.com/user-attachments/assets/6e5c757c-1d71-42b1-a7dc-59356d7382ff" />

Обнаружено 3 уязвимости за 12 секунд.

Раскрытие версий: Werkzeug/3.1.4 + Python/3.12.3 (информационная утечка).

Отсутствует заголовок X-Frame-Options → уязвимость к clickjacking.

Nikto отметил возможный интересный путь /console (вероятно, Flask debug-консоль с PIN — критическая уязвимость RCE в debug-режиме).

Другие серьёзные уязвимости (SQL Injection, устаревшие Flask/requests) Nikto не нашёл — для них лучше использовать OWASP ZAP.



#### 2.2. Анализ с помощью OWASP ZAP

Запуск сканирования:

<img width="974" height="332" alt="image" src="https://github.com/user-attachments/assets/e60d2d68-0ef4-41e4-b38b-c112e8ce7c2b" />

Алерты:

<img width="606" height="364" alt="image" src="https://github.com/user-attachments/assets/d74dc91b-c794-4aac-a6aa-3e3c3c710be9" />

OWASP ZAP обнаружил следующие уязвимости в приложении:


Высокого риска: 

SQL-инъекция в SQLite (2 случая, вероятно в форме логина — позволяет обходить аутентификацию, извлекать или модифицировать данные базы); 

внедрение уязвимых команд операционной системы (OS Command Injection — возможен запуск произвольных команд на сервере с правами приложения); 

внедрение шаблона на стороне сервера (Server-Side Template Injection, SSTI в Jinja2 — может привести к выполнению произвольного кода).

Среднего и низкого риска: 

заголовок Content Security Policy (CSP) не задан (увеличивает риск XSS и других атак); 

отсутствие атрибута SameSite у cookies (риск CSRF и кражи сессий); 

заголовок X-Content-Type-Options отсутствует (возможна MIME-sniffing атака); 

заголовок X-Frame-Options отсутствует или не настроен (уязвимость к clickjacking); 

утечка информации о версии сервера через заголовки (раскрывает стек технологий).

Информационные: обнаружены запросы аутентификации и механизмы управления сессиями (полезно для дальнейшего тестирования).

---
#### 2.3. Анализ с помощью nuclei 

<img width="974" height="753" alt="image" src="https://github.com/user-attachments/assets/d9d0191d-2c06-4bee-9ff5-b814a1015693" />

nuclei выполнил два скана (-as и -dast) и нашёл cледующие уязвимости:

[tech-detect/python] Обнаружена технология Python. Информационная находка, но подтверждает стек приложения.

[werkzeug-debugger-detect] (2 матча) Критическая уязвимость: обнаружен включённый Werkzeug Debug Mode (интерактивная отладочная консоль Flask).
→ Путь: http://localhost:5000/console
→ Это позволяет выполнить произвольный Python-код на сервере (Remote Code Execution). Атакующий, знающий или перехвативший PIN (который показывается в терминале при запуске), получает полный контроль.
[wappalyzer] (2 детекта, 3 матча) Nuclei через интеграцию с Wappalyzer дополнительно подтвердил технологии (Python + Werkzeug/Flask).

Так же Nuclei нашёл главную критическую уязвимость — открытую Flask debug-консоль (/console), которая даёт RCE в development-режиме
#### 2.4. Вывод по сканерам 

Nikto нашёл базовые миссконфигурации: раскрытие версий сервера (Werkzeug и Python), отсутствие заголовка X-Frame-Options (уязвимость к clickjacking) и отметил возможный интересный путь /console. Логических уязвимостей вроде SQL-инъекции он не обнаружил — это его ограничение.
OWASP ZAP показал самый полный результат: выявил критические инъекционные уязвимости — SQL Injection в SQLite (два случая, в форме логина), OS Command Injection, Server-Side Template Injection (SSTI). Кроме того, нашёл отсутствие важных заголовков безопасности (CSP, X-Frame-Options, X-Content-Type-Options, SameSite для cookies) и утечку версии сервера.
Nuclei точно поймал самую опасную уязвимость — включённый Werkzeug/Flask Debug Mode с открытой консолью на пути /console (это прямой Remote Code Execution через ввод PIN). Также подтвердил обнаружение технологий (Python и Werkzeug). Остальные инъекции (SQLi, SSTI, Command Injection) в этом запуске не нашёл, вероятно из-за ограничений выбранных шаблонов
#### 3.1. Триаж уязвимостей

**Включённый режим отладки Flask с доступной консолью Werkzeug (/console)**

Обнаружено: Nuclei и Nikto.

Верификация: подтверждено — доступна интерактивная консоль Python с возможностью выполнения кода при известном PIN.

Воздействие: полная компрометация сервера (RCE).

Оценка CVSS: 9.8 (Critical).

Сетевая доступность: из любой сети, где доступен веб-сервер.

Потенциальный ущерб для бизнеса: критический — полный контроль над сервером может привести к утечке всех данных.




**Выполнение системных команд (OS Command Injection) через subprocess с shell=True**

Обнаружено: Bandit.

Верификация: код содержит опасные вызовы subprocess — подтверждено анализом исходников.

Воздействие: удалённое выполнение произвольных команд от имени веб-сервера.

Оценка CVSS: 9.8 (Critical).

Сетевая доступность: из любой сети с доступом к приложению (интернет/интранет).

Потенциальный ущерб для бизнеса: критический — возможна установка вредоносного ПО, шифрование данных (ransomware).




**Опасная десериализация через pickle.loads()**

Обнаружено: Bandit.

Верификация: прямой вызов pickle.loads() над внешними данными — подтверждено.

Воздействие: RCE при передаче специально сформированных данных.

Оценка CVSS: 9.8 (Critical).

Сетевая доступность: из любой сети с доступом к функции десериализации.

Потенциальный ущерб для бизнеса: высокий — компрометация сервера, утечка данных.




**SQL-инъекция**

Обнаружено: OWASP ZAP.

Верификация: подтверждено — обход аутентификации и извлечение данных из БД.

Воздействие: утечка/модификация данных в БД.

Оценка CVSS: 9.1 (Critical).

Сетевая доступность: из любой сети с доступом к формам ввода.

Потенциальный ущерб для бизнеса: высокий — утечка конфеденциальных данных,хранимых в БД.




**Server-Side Template Injection (SSTI) в Jinja2**

Обнаружено: OWASP ZAP.

Верификация: пользовательский ввод рендерится в шаблонах без фильтрации — подтверждено.

Воздействие: выполнение произвольного кода на сервере.

Оценка CVSS: 9.8 (Critical).

Сетевая доступность: из любой сети с доступом к уязвимым полям ввода.

Потенциальный ущерб для бизнеса: критический — полный контроль над сервером, аналогичный RCE.



**Отсутствие защитных HTTP-заголовков**

Обнаружено: OWASP ZAP и Nikto.

Верификация: заголовки отсутствуют — приложение уязвимо к clickjacking и XSS.

Воздействие: облегчение других атак.

Оценка CVSS: 6.5–7.5 (Medium/High).

Сетевая доступность: только при доступе из интернета.

Потенциальный ущерб для бизнеса: средний — возможные атаки на пользователей.




**Утечка информации о версиях ПО**

Обнаружено: Nikto и Nuclei.

Верификация: заголовок Server раскрывает версии Werkzeug/Python.

Воздействие: помогает атакующему в разведке.

Оценка CVSS: 5.3 (Medium).

Сетевая доступность: из любой сети.

Потенциальный ущерб для бизнеса: низкий — только информационная утечка, косвенно повышает риск целевых атак.


#### 3.2. Таблица
<img width="872" height="616" alt="image" src="https://github.com/user-attachments/assets/7c58c1e6-4400-40e1-94db-4132e5c7f8d4" />


#### 3.3. Контрольные вопросы


    В чем принципиальное отличие SAST от DAST?

   - SAST анализирует исходный код без запуска приложения, DAST тестирует работающее приложение через внешние атаки.

    Какие типы уязвимостей лучше обнаруживает SAST?

   - SAST лучше находит SQL-инъекции, XSS, утечки памяти, небезопасные криптографические функции, чувствительные данные.

    Какие типы уязвимостей лучше обнаруживает DAST?

  -  DAST лучше находит конфигурационные ошибки сервера, проблемы аутентификации/сессий, runtime уязвимости, бизнес-логику.

    Почему важно использовать оба метода в процессе разработки?

   - Оба метода дополняют друг друга: SAST находит кодные ошибки на ранних стадиях, DAST проверяет реальное поведение в среде выполнения.

    Какие ограничения имеют каждый из методов?

   - Ограничения: SAST - ложные срабатывания, не видит runtime проблемы; DAST - не видит исходный код, требует запущенного приложения.

    Что такое AppSec?

   - AppSec (Application Security) - процесс обеспечения безопасности приложений на всех этапах жизненного цикла разработки.

    Что такое триаж уязвимостей и каковы его основные цели?

  -  Триаж уязвимостей - процесс приоритизации уязвимостей на основе риска. Цели: оптимизация ресурсов, фокус на критических угрозах.

    Чем простое сканирование на уязвимости отличается от полноценного процесса триажа?

   - Сканирование просто находит уязвимости, триаж добавляет анализ риска, бизнес-контекста и приоритезацию исправлений.

    Почему автоматический сканер не может полностью заменить человека в процессе триажа? Какие его ограничения компенсирует аналитик?

  -  Автосканер не понимает контекст, бизнес-логику, дает ложные срабатывания. Аналитик оценивает реальный риск и эксплуатацию.

    Почему важно документировать решение об отложении исправления уязвимости с низким приоритетом?

 -   Документирование уязвимостей с низким приоритом необходимо для аудита, а также для обоснования решений перед руководством.


